cmake_minimum_required(VERSION 3.6.3)
project(log4cplus-download NONE)

set(BUILD_SHARED_LIBS ON)
if (BUILD_STATIC)
  set(BUILD_SHARED_LIBS OFF)
endif()

set(EXTRA_CMAKE_ARGS "")
if (DEFINED BUILD_LOG4CPLUS_HOST AND NOT BUILD_LOG4CPLUS_HOST STREQUAL "OFF")
  list(APPEND EXTRA_CMAKE_ARGS "-DCMAKE_SYSTEM_NAME=${BUILD_LOG4CPLUS_HOST}")
endif()

include(ExternalProject)

if (WIN32)
  list(APPEND EXTRA_CMAKE_ARGS "-DUNICODE=0")
endif()

ExternalProject_Add(project_log4cplus
  GIT_REPOSITORY    https://github.com/log4cplus/log4cplus
  GIT_TAG           REL_2_1_2
  GIT_SHALLOW       TRUE
  GIT_PROGRESS      TRUE
  PREFIX            ${CMAKE_CURRENT_BINARY_DIR}/build
  CMAKE_ARGS
    -DCMAKE_INSTALL_PREFIX=${OPEN_SRC_INSTALL_PREFIX}
    -DBUILD_SHARED_LIBS=${BUILD_SHARED_LIBS}
    -DLOG4CPLUS_ENABLE_THREAD_POOL=OFF
    -DLOG4CPLUS_BUILD_TESTING=OFF
    -DLOG4CPLUS_BUILD_LOGGINGSERVER=OFF
    -DCMAKE_BUILD_TYPE=${CMAKE_BUILD_TYPE}
    ${EXTRA_CMAKE_ARGS}
  BUILD_ALWAYS      TRUE
  TEST_COMMAND      ""
)
